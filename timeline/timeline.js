var dates = [
		"Oct. 2010",
		"Nov. 2010",
		"Dec. 2010",
		"Jan. 2011",
		"Feb. 2011",
		"Mar. 2011",
		"Apr. 2011",
		"May. 2011",
		"Jun. 2011",
		"Jul. 2011",
		"Aug. 2011",
		"Sept. 2011",
		"Oct. 2011",
		"Nov. 2011",
		"Dec. 2011",
		"Jan. 2012",
		"Feb. 2012",
		"Mar. 2012",
		"Apr. 2012",
		"May. 2012",
		"Jun. 2012",
		"Jul. 2012",
		"Aug. 2012",
		"...Present"
	];

var bands = {
	freefood:{
		start:1,
		preview:"<img src='image/media/thumbs/freefood.jpg' alt='Free Food'><h2>Free Food</h2><p>October 2010</p>",
		content:'<h1>Free Food</h1><h3>October 2010</h3>\
        <p>The funk and hip-hop fusion group, Free Food, began slowly playing music together as early as fall 2010, and soon formed a full band. Centered around the rap stylings of fourth-year ethnomusicology student Oliver Brown, who performs under the stage name Scaredy Kat MC, Free Food combines Brown’s rapping with a five-piece brass and rhythm section.</p>\
        <div id="slideshowcontainer">\
        &nbsp;\
        <div id="slideshow">\
          <div id="images">\
            <img src="image/media/freefood/1.JPG"/>\
            <img src="image/media/freefood/2.JPG"/>\
            <img src="image/media/freefood/3.JPG"/>\
            <img src="image/media/freefood/4.JPG"/>\
            <img src="image/media/freefood/5.JPG"/>\
            <img src="image/media/freefood/6.JPG"/>\
            <img src="image/media/freefood/7.JPG"/>\
            <img src="image/media/freefood/8.JPG"/>\
          </div>\
        </div>\
        </div>\
        <aside class="intCredit"><em><strong>Brandon Choe</strong> / Daily Bruin</em></aside>\
        <div id="thumbnails">\
        </div>'
	},
	alto:{
		start:3,
		preview:"<img src='image/media/thumbs/alto.jpg' alt='Alto'><h2>Alto</h2><p>December 2010</p>",
		content:'<h1>Alto</h1><h3>December 2010</h3>\
        <p>The indie-folk band that dominated Spring Sing last year had been performing as a duo between fourth-year music education and music performance student Jessica Jones on double bass and fourth-year ethnomusicology student Nicolette Yarbrough on violin since late 2010. By the end of 2011, they had added fourth-year music performance and psychology student Veronica Rogers on viola and UCLA alumnus Joseph Lorge on guitar to round out their alternative sound.</p>\
        <div id="slideshowcontainer">\
        &nbsp;\
        <div id="slideshow">\
          <div id="images">\
            <img src="image/media/alto/1.JPG"/>\
            <img src="image/media/alto/2.JPG"/>\
            <img src="image/media/alto/3.JPG"/>\
            <img src="image/media/alto/4.JPG"/>\
            <img src="image/media/alto/5.JPG"/>\
            <img src="image/media/alto/6.JPG"/>\
            <img src="image/media/alto/7.JPG"/>\
            <img src="image/media/alto/8.JPG"/>\
          </div>\
        </div>\
        </div>\
        <aside class="intCredit"><em><strong>Daily Bruin Video</strong></em></aside>\
        <div id="thumbnails">\
        </div>'
	},
	thetenthousand:{
		start:6,
		preview:"<img src='image/media/thumbs/tenthousand.jpg' alt='The Ten Thousand'><h2>The Ten Thousand</h2><p>April 2011</p>",
		content:'<h1>The Ten Thousand</h1><h3>April 2011</h3>\
        <p>After hearing about the live music at Midvale Sessions, the members of the rock ‘n’ roll band The Ten Thousand quickly formed and began performing. Led by the vocals of UCLA alumnus Kevin Daye, the guitar solos of fourth-year psychology student Dylan Robin and the bass lines of fourth-year jazz studies student Nathan Kersey-Wilson, The Ten Thousand produce a West coast rock ‘n’ roll sound.</p>\
        <div id="slideshowcontainer">\
        &nbsp;\
        <div id="slideshow">\
          <div id="images">\
            <img src="image/media/tenthousand/1.JPG"/>\
            <img src="image/media/tenthousand/2.JPG"/>\
            <img src="image/media/tenthousand/3.JPG"/>\
            <img src="image/media/tenthousand/4.JPG"/>\
            <img src="image/media/tenthousand/5.JPG"/>\
            <img src="image/media/tenthousand/6.JPG"/>\
            <img src="image/media/tenthousand/7.JPG"/>\
            <img src="image/media/tenthousand/8.JPG"/>\
          </div>\
        </div>\
        </div>\
        <aside class="intCredit"><em><strong>Brandon Choe</strong> / Daily Bruin</em></aside>\
        <div id="thumbnails">\
        </div>'
	},
	theinternship:{
		start:6,
		preview:"<img src='image/media/thumbs/theinternship.jpg' alt='The Internship'><h2>Manzanita</h2><p>(The Internship)</p><p>April 2011</p>",
		content:'<h1>Manzanita (The Internship)</h1><h3>April 2011</h3>\
        <p>The self-proclaimed “thoughtful rock” group began as The Internship in April 2011, with the sole goal to play for the growing crowds at Midvale Sessions. The group soon accomplished this goal, accompanying its artful rock guitars with the soulful voice of UCLA alumnus Moses Sumney, a former Daily Bruin contributor. After a lineup change in 2012, the band became Manzanita, and have continued to play its brand of rock ‘n’ roll.</p>\
        <div id="slideshowcontainer">\
        &nbsp;\
        <div id="slideshow">\
          <div id="images">\
            <img src="image/media/theinternship/1.JPG"/>\
            <img src="image/media/theinternship/2.JPG"/>\
            <img src="image/media/theinternship/3.JPG"/>\
            <img src="image/media/theinternship/4.JPG"/>\
            <img src="image/media/theinternship/5.JPG"/>\
            <img src="image/media/theinternship/6.JPG"/>\
            <img src="image/media/theinternship/7.JPG"/>\
            <img src="image/media/theinternship/8.JPG"/>\
          </div>\
        </div>\
        </div>\
        <aside class="intCredit"><em><strong>Brandon Choe</strong> / Daily Bruin</em></aside>\
        <div id="thumbnails">\
        </div>'
	},
	owlflysouth:{
		start:7,
		preview:"<img src='image/media/thumbs/owlflysouth.jpg' alt='Owl Fly South'><h2>Owl Fly South</h2><p>May 2011</p>",
		content:'<h1>Owl Fly South</h1><h3>May 2011</h3>\
        <p>Beginning as a duo between guitarist and fourth-year ethnomusicology student Braeden Henderson and drummer and third-year ethnomusicology student Oliver Dobrian, Owl Fly South fuses a traditional garage rock sound with hints of psychedelic and progressive rock. Now a four-piece rock ‘n’ roll band, Owl Fly South recently played the legendary Echo Theater in the Echo Park neighborhood of Los Angeles.</p>\
        <div id="slideshowcontainer">\
        &nbsp;\
        <div id="slideshow">\
          <div id="images">\
            <img src="image/media/owlflysouth/1.JPG"/>\
            <img src="image/media/owlflysouth/2.JPG"/>\
            <img src="image/media/owlflysouth/3.JPG"/>\
            <img src="image/media/owlflysouth/4.JPG"/>\
            <img src="image/media/owlflysouth/5.JPG"/>\
            <img src="image/media/owlflysouth/6.JPG"/>\
            <img src="image/media/owlflysouth/7.JPG"/>\
            <img src="image/media/owlflysouth/8.JPG"/>\
          </div>\
        </div>\
        </div>\
        <aside class="intCredit"><em><strong>Brandon Choe</strong> / Daily Bruin</em></aside>\
        <div id="thumbnails">\
        </div>'
	}
}

var venues = {
	midSesh:{
		start:4,
		end:13,
		preview:"<img src='image/media/thumbs/midvale.jpg' alt='Owl Fly South'><h2>Midvale Sessions</h2><p>January 2011</p>",
		content:'<h1>Midvale Sessions</h1><h3>January 2011 - October 2011</h3>\
        <p>Midvale Sessions was the catalyzing force of the music scene at UCLA, opening up an apartment to hundreds of students wanting to hear live music. Each of the 11 concerts held at Midvale Sessions featured magic by UCLA alumnus Aaron Rabkin, followed by sets from student bands playing original songs and covers of popular songs.</p>\
        <div id="slideshowcontainer">\
        &nbsp;\
        <div id="slideshow">\
          <div id="images">\
            <img src="image/media/midvale/1.JPG"/>\
            <img src="image/media/midvale/2.JPG"/>\
            <img src="image/media/midvale/3.JPG"/>\
            <img src="image/media/midvale/4.JPG"/>\
            <img src="image/media/midvale/5.JPG"/>\
            <img src="image/media/midvale/6.JPG"/>\
            <img src="image/media/midvale/7.JPG"/>\
            <img src="image/media/midvale/8.JPG"/>\
          </div>\
        </div>\
        </div>\
        <aside class="intCredit"><em><strong>Leah Rom</strong> / Daily Bruin</em></aside>\
        <div id="thumbnails">\
        </div>'
	}
}

//Wrote this function because I was too lazy to hardcode the positioning into the nodes
function rule(length,cur,index) {
	if (cur>=index) {
		return 0;
	}
	var newLength = length/17.817;
	return newLength + rule(length-newLength,cur+1,index);
}

//Duplicated code... whatever. It's 4am in the morning
function renderFrets() {
	var neck = document.getElementById("neckBody");
	var neckWidth = neck.style.width;
	console.log(neck);	
	//Wee!! recursive goodness
	function ruleofeighteen(width, cur, count) {
		if (count > 24) {
			return;
		}
		var posish = width/17.817;
		if (count == 12)
		{
			neck.innerHTML = neck.innerHTML + '<div id="twelfthInlay" style="left: ' + Math.floor(cur+posish/2-14) + 'px;"><div>&nbsp;</div><div>&nbsp;</div></div>';
		}
		else if (count > 1 && count%2!=0 && count != 11 && count !=13) {
			neck.innerHTML = neck.innerHTML + '<div class="guitarInlay" style="left: ' + Math.floor(cur+posish/2-14) + 'px;"></div>';
		}
		neck.innerHTML = neck.innerHTML + '<div class="guitarFret" style="left: ' + Math.floor(cur+posish) + 'px;"><h3>'+dates[count-1]+'</h3></div>';
		ruleofeighteen(width-posish,cur+posish,count+1);
		return;
	}
	ruleofeighteen(3300,0,1);
}

/**function renderBands() {
	var string = document.getElementById("bands");
	for(var id in bands) {
		var start = bands[id].start;
		string.innerHTML = string.innerHTML + '<div class="hover" id="'+id+'"><div class="band" style="left: '+Math.floor(rule(3300,0,start)+107)+'px;"></div><article class="preview" style="left: '+Math.floor(rule(3300,0,start))+'px;">'+bands[id].preview+'</article></div>';	
	}
}**/

function renderBands() {
	for(var id in venues) {
		var string = document.getElementById(id);
		var start = venues[id].start;
		if(venues[id].end)
			var end = venues[id].end;
		else
			var end = 24;
		var width = Math.floor(rule(3300,0,end)-rule(3300,0,start));
		string.innerHTML = string.innerHTML + '<div class="hover" id="'+id+'" style="height: inherit;"><div class="venue" style="width: '+width+'px; left: '+Math.floor(rule(3300,0,start)+207)+'px;"></div><article class="preview" style="left: '+Math.floor(rule(3300,0,start)+207)+'px;">'+venues[id].preview+'</article></div>';	
	}
}

function renderVenues() {
	for(var id in bands) {
		var string = document.getElementById(id);
		var start = bands[id].start;
		if(bands[id].end)
			var end = bands[id].end;
		else
			var end = 24;
		var width = Math.floor(rule(3300,0,end)-rule(3300,0,start));
		string.innerHTML = string.innerHTML + '<div class="hover" id="'+id+'" style="height: inherit;"><div class="venue" style="width: '+width+'px; left: '+Math.floor(rule(3300,0,start)+207)+'px;"></div><article class="preview" style="left: '+Math.floor(rule(3300,0,start)+207)+'px;">'+bands[id].preview+'</article></div>';	
	}
}

function loadJSlider() {

    var imageString = $('#images').html();
    $('#thumbnails').html(imageString);
    var numImages = 0;
    $('#slideshow img').each(function(){numImages++;}).hide().first().show();
    $('#thumbnails img').eq(0).css({'border':'5px solid rgba(0,0,255,0.5)','margin':'0px'});
    $('#slideshowcontainer').append('<div id="picnavleft" class="picnav"><a href="#" class="arrows">&lt;</a></div><div id="picnavright" class="picnav"><a href="#" class="arrows">&gt;</a></div>');

    var heightImage = $('#slideshow img').height();
    var heightNav = $('.arrows').eq(0).height();
    var paddingOffset = Math.floor((heightImage-heightNav)/2);
    var heightAdjusted = heightImage-paddingOffset;
    $('.picnav').css({'margin-top':paddingOffset});

    var curPicIndex = 0
    $('#picnavright').click(
        function()
        {
            $('#slideshow img').eq(curPicIndex).hide("slide", {direction: "left"}, 700);
            $('#thumbnails img').eq(curPicIndex).css({'border':'none','margin':'5px'});
            if (curPicIndex < numImages-1)
                $('#slideshow img').eq(++curPicIndex).show("slide", {direction: "right"}, 700);
            else
            {
                curPicIndex=0;
                $('#slideshow img').eq(curPicIndex).show("slide", {direction: "right"}, 700);
            }
            $('#thumbnails img').eq(curPicIndex).css({'border':'5px solid rgba(0,0,255,0.5)','margin':'0px'});
            $('#thumbnails').scrollLeft(curPicIndex * 114);
        }
    );

    $('#picnavleft').click(
        function()
        {
            $('#slideshow img').eq(curPicIndex).hide("slide", {direction: "right"}, 700);
            $('#thumbnails img').eq(curPicIndex).css({'border':'none','margin':'5px'});
            if (curPicIndex > 0)
                $('#slideshow img').eq(--curPicIndex).show("slide", {direction: "left"}, 700);
            else
            {
                curPicIndex=numImages-1;
                $('#slideshow img').eq(curPicIndex).show("slide", {direction: "left"}, 700);
            }
            $('#thumbnails img').eq(curPicIndex).css({'border':'5px solid rgba(0,0,255,0.5)','margin':'0px'});
            $('#thumbnails').scrollLeft(curPicIndex * 114);
        }
    );

    $('#thumbnails img').click(
        function()
        {
            if (curPicIndex!=$(this).index())
            {
                if (curPicIndex<$(this).index())
                {
                    $('#slideshow img').eq(curPicIndex).hide("slide", {direction: "left"}, 700);
                    $('#thumbnails img').eq(curPicIndex).css({'border':'none','margin':'5px'});
                    curPicIndex = $(this).index();
                    $('#slideshow img').eq(curPicIndex).show("slide", {direction: "right"}, 700);
                    $('#thumbnails img').eq(curPicIndex).css({'border':'5px solid rgba(0,0,255,0.5)','margin':'0px'});
                }
                else
                {
                    $('#slideshow img').eq(curPicIndex).hide("slide", {direction: "right"}, 700);
                    $('#thumbnails img').eq(curPicIndex).css({'border':'none','margin':'5px'});
                    curPicIndex = $(this).index();
                    $('#slideshow img').eq(curPicIndex).show("slide", {direction: "left"}, 700);
                    $('#thumbnails img').eq(curPicIndex).css({'border':'5px solid rgba(0,0,255,0.5)','margin':'0px'});
                }
            }
        }
    );
}

function destructJSlider() {
	$('#picnavright, #picnavleft, #thumbnails').unbind();
}

$(document).ready(function(){
	renderFrets();
	renderBands();
	renderVenues();

	$('.hover').click(function(e){
		var id = $(this).attr("id");
		console.log(id);
		console.log(bands[id]);
		if(bands[id])
		{
			$('#backdrop').fadeIn(1000);
			$('#lightbox').fadeIn(1000,function(){
				$('#lightbox').html(bands[id].content);
				loadJSlider();
			});
		}
		else if(venues[id])
		{
			$('#backdrop').fadeIn(1000);
			$('#lightbox').fadeIn(1000,function(){
				$('#lightbox').html(venues[id].content);
				loadJSlider();
			});
		}
		e.preventDefault();
	});

	$('#backdrop').click(function(e){
		$('#backdrop').fadeOut(1000);
		$('#lightbox').fadeOut(1000,function(){
			$('#lightbox').html('<img class="loading" src="image/ajax-loader.gif" alt="loading...">');
		});
		destructJSlider();
		e.preventDefault();
	});

	$(document).keyup(function(e){
        if (e.keyCode==27)
        {
            $('#backdrop').fadeOut(1000);
			$('#lightbox').fadeOut(1000,function(){
				$('#lightbox').html('<img class="loading" src="image/ajax-loader.gif" alt="loading...">');
			});
			destructJSlider();
			e.preventDefault();
        }
    });
})
